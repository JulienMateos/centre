<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Centre ‚Äî Ana‚ÄëRose AI Command Center</title>
  <style>
    :root{
      --bg:#0b0e1a;--bg2:#12162a;--card:#161a2e;--muted:#a7b0c6;--text:#e9ecf8;
      --accent:#7aa2ff;--accent2:#00d4a7;--danger:#ff6b6b;--warn:#ffd166;--ok:#78e08f;
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:linear-gradient(180deg,var(--bg),var(--bg2));color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Inter,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:1200px;margin:26px auto;padding:0 18px 40px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:14px;height:14px;border-radius:4px;background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 0 22px rgba(122,162,255,.45)}
    .title{font-weight:800;letter-spacing:.2px}
    .clock{color:var(--muted);font-size:13px}
    .grid{display:grid;gap:16px;grid-template-columns:1.25fr 1fr}
    .card{background:rgba(22,26,46,.78);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius);padding:16px 16px 12px;box-shadow:0 10px 28px rgba(0,0,0,.25)}
    h2{margin:0 0 8px;font-size:18px}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;color:#09101f;
      background:linear-gradient(135deg,var(--accent),var(--accent2));font-weight:800;letter-spacing:.3px}
    .dual{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    ul{margin:8px 0 0 18px} li{margin:6px 0}
    .kpi{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .chip{padding:6px 10px;border:1px solid rgba(255,255,255,.08);border-radius:10px;font-size:12px;color:var(--muted);
      background:rgba(255,255,255,.03)}
    .emails .row{display:grid;grid-template-columns:62px 1fr 100px;align-items:center;gap:10px;padding:10px;
      border-radius:12px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);margin-top:8px}
    .pct{font-weight:800}.red{color:var(--danger)}.yellow{color:var(--warn)}.green{color:var(--ok)}
    .btn{appearance:none;border:none;cursor:pointer;padding:10px 14px;border-radius:12px;font-weight:800;color:#0b0e1a;
      background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 8px 22px rgba(0,212,167,.25)}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .small{font-size:12px;color:var(--muted)}
    footer{margin-top:14px;text-align:right;color:var(--muted);font-size:12px}
    .error{color:#ffd166}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand"><div class="logo"></div><div class="title">Centre ‚Äî AI Command Center</div></div>
      <div class="clock" id="clock">Loading‚Ä¶</div>
    </header>

    <div class="grid">
      <section class="card" id="newsCard">
        <h2>üåç Daily World & Economic Brief <span class="pill">FR / EN</span></h2>
        <div id="newsContent">Loading news‚Ä¶</div>
        <div class="actions">
          <a class="btn" href="https://chat.openai.com" target="_blank" rel="noopener">Ask Ana‚ÄëRose AI</a>
          <span class="small">Ask questions about today‚Äôs brief or request email replies.</span>
        </div>
      </section>

      <aside class="card" id="planCard">
        <h2>‚úÖ Today‚Äôs Plan / Plan du jour</h2>
        <div id="planContent">Loading plan‚Ä¶</div>
      </aside>
    </div>

    <section class="card emails" id="emailsCard">
      <h2>üì© Important Emails (AI triage) / E‚Äëmails importants</h2>
      <div id="emailsContent">Loading emails‚Ä¶</div>
    </section>

    <footer>Last updated: <span id="updated">2025-10-01 14:48 UTC</span></footer>
  </div>

  <script>
    function clock(){
      const el=document.getElementById('clock');
      const d=new Date();
      el.textContent=d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})+' ‚Ä¢ '+d.toDateString();
    }
    clock(); setInterval(clock,1000);

    async function safeFetch(path){
      try{
        const res=await fetch(path,{cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        return await res.json();
      }catch(e){
        return {error:true,message:e.message};
      }
    }

    function renderNews(data){
      const el=document.getElementById('newsContent');
      if(data.error){ el.innerHTML = '<div class="error">Could not load news.json ‚Äî ensure /data/news.json exists.</div>'; return; }
      const fr = (data.fr && data.fr.sections) ? data.fr.sections : [];
      const en = (data.en && data.en.sections) ? data.en.sections : [];
      const kpi = data.kpi || [];

      el.innerHTML = `
        <div class="dual">
          <div>
            <strong>FR ‚Äî Monde / Business / Tech</strong>
            <ul>${fr.map(s=>`<li><em>${s.title}:</em> ${s.text}</li>`).join('')}</ul>
            <div class="kpi">${kpi.map(x=>`<div class="chip">${x}</div>`).join('')}</div>
          </div>
          <div>
            <strong>EN ‚Äî World / Business / Tech</strong>
            <ul>${en.map(s=>`<li><em>${s.title}:</em> ${s.text}</li>`).join('')}</ul>
            <div class="kpi">${kpi.map(x=>`<div class="chip">${x}</div>`).join('')}</div>
          </div>
        </div>
        ${data.story ? `<div style="margin-top:10px" class="small"><strong>Story/Pourquoi √ßa compte:</strong> ${data.story}</div>` : ''}
      `;
    }

    function renderPlan(data){
      const el=document.getElementById('planContent');
      if(data.error){ el.innerHTML = '<div class="error">Could not load plan.json ‚Äî ensure /data/plan.json exists.</div>'; return; }
      const hard = data.hard || [];
      const must = data.must || [];
      const nice = data.nice || [];
      const focus = data.focus || [];

      el.innerHTML = `
        <ul>${hard.map(x=>`<li><strong>${x.time || ''}</strong> ${x.text}</li>`).join('')}</ul>
        ${must.length?`<div class="kpi">${must.map(x=>`<div class="chip">Must: ${x}</div>`).join('')}</div>`:''}
        ${nice.length?`<div class="kpi">${nice.map(x=>`<div class="chip">Nice: ${x}</div>`).join('')}</div>`:''}
        ${focus.length?`<div class="kpi">${focus.map(x=>`<div class="chip">Focus: ${x}</div>`).join('')}</div>`:''}
      `;
    }

    function renderEmails(data){
      const el=document.getElementById('emailsContent');
      if(data.error){ el.innerHTML = '<div class="error">Could not load emails.json ‚Äî ensure /data/emails.json exists.</div>'; return; }
      const rows=(data.items||[]).map(item=>{
        const pctClass = item.score>=80?'red':(item.score>=40?'yellow':'green');
        const btn = item.suggest ? 'Suggest Reply' : 'Open';
        const action = item.suggest ? 'suggest' : 'open';
        return `<div class="row">
          <div class="pct ${pctClass}">${item.score}%</div>
          <div><strong>${item.from}</strong> ‚Äî ${item.subject}</div>
          <button class="btn" onclick="alert('${action} for: ${item.subject.replace(/'/g,'\'')}')">${btn}</button>
        </div>`;
      }).join('');
      el.innerHTML = rows || '<div class="small">No important emails.</div>';
    }

    (async function init(){
      const news = await safeFetch('./data/news.json');
      const plan = await safeFetch('./data/plan.json');
      const emails = await safeFetch('./data/emails.json');
      renderNews(news);
      renderPlan(plan);
      renderEmails(emails);
      setTimeout(()=>location.reload(), 10*60*1000);
    })();
  </script>
</body>
</html>
